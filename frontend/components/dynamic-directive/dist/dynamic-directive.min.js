"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}!function(a){var b=0,c=0,d=function d(e,f,g){if(_classCallCheck(this,d),!f)throw new Error("DynamicInjection: name argument should be a string");if(this.name=f,e===!0)e=function(){return!0};else if(!e||!a.isFunction(e))throw new Error("DynamicInjection: injectionFunction argument should be a function");this.injectionFunction=e,g=g||{},this.attributes=g.attributes||[],this.scope=g.scope||void 0,this.priority=isNaN(parseInt(g.priority,10))?c:parseInt(g.priority,10),this._id=++b};a.module("op.dynamicDirective",[]).provider("dynamicDirectiveService",function(){function a(a,b,c){return b.name<a.name?-1:b.name>a.name?1:c(a,b)}function b(a,b){return b._id<a._id?-1:b._id>a._id?1:0}function c(c,d){var e=d.priority-c.priority;return 0!==e?e:d.name<c.name?-1:d.name>c.name?1:a(c,d,b)}function e(a){j[a]=j[a]||[]}function f(a,b){e(a);var c=j[a];return c.filter(function(a){return a.injectionFunction(b)})}function g(a,b){e(a),j[a].push(b)}function h(a){j[a]=[]}function i(a){return a.sort(c),a}var j={};return{addInjection:g,DynamicDirective:d,$get:["$rootScope",function(a){return{DynamicDirective:d,getInjections:f,sort:i,addInjection:function(b,c){g(b,c),a.$broadcast("dynamicDirectiveInjectionUpdated",b,c)},resetInjections:function(b){h(b),a.$broadcast("dynamicDirectiveInjectionUpdated",b)}}}]}}()).value("DynamicDirective",d).directive("dynamicDirective",["$compile","dynamicDirectiveService",function(b,c){function d(b,d){var e=c.sort(d).map(function(a){return a._id}),g=b.children("["+f+"]").map(function(b,c){return parseInt(a.element(c).attr(f),10)}).toArray();if(e.join(",")!==g.join(","))for(var h=0,i=e.length-2;i>=h;h++){var j=e[h],k=e[h+1],l=b.children("["+f+"="+j+"]");l.next().attr(f)!==k&&b.children("["+f+"="+k+"]").insertAfter(l)}}function e(e,g,h){function i(c){var d=a.element(j(c)),f=b(d)(c.scope||e);g.append(f)}function j(b){var c={};c[f]=b._id,b.attributes.forEach(function(a){return c[a.name]=a.value});var d=a.element("<"+b.name+"/>");return d.attr(c),d}function k(){g.children().length?g.show():g.hide()}var l=h.dynamicDirective;g.hide();var m=c.sort(c.getInjections(l,e));m.forEach(i),k(),e.$on("dynamicDirectiveInjectionUpdated",function(b,h){if(h===l){var j=c.sort(c.getInjections(l,e)),m={},n={};j.forEach(function(a){return m[a._id]=a}),g.children().each(function(b,c){var d=a.element(c),e=d.attr(f);if(e)return m[e]?void(n[e]=!0):void d.remove()});var o=Object.keys(m).length,p=Object.keys(n).length;o!==p&&Object.keys(m).forEach(function(a){n[a]||i(m[a])}),d(g,j),k()}})}var f="dynamic-directive-id";return{restrict:"A",link:e}}])}(angular);
//# sourceMappingURL=dynamic-directive.min.js.map